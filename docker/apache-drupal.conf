<VirtualHost *:80>
    DocumentRoot /var/www/html/web
    ServerName localhost
    
    <Directory "/var/www/html/web">
        AllowOverride All
        Require all granted
        Options -Indexes +FollowSymLinks
        
        # Security headers
        Header always set X-Content-Type-Options nosniff
        Header always set X-Frame-Options SAMEORIGIN
        Header always set X-XSS-Protection "1; mode=block"
    </Directory>
    
    # Deny access to sensitive Drupal files (but allow index.php and other entry points)
    <FilesMatch "\.(engine|inc|install|make|module|profile|po|sh|.*sql|theme|twig|tpl(\.php)?|xtmpl|yml|yaml)$">
        Require all denied
    </FilesMatch>
    
    # Deny access to backup files
    <FilesMatch "\.php(~|\.sw[op]|\.bak|\.orig|\.save)$">
        Require all denied
    </FilesMatch>
    
    # Deny access to composer files
    <FilesMatch "^composer\.(json|lock)$">
        Require all denied
    </FilesMatch>
    
    # Deny access to hidden files
    <FilesMatch "^\.">
        Require all denied
    </FilesMatch>
    
    # Deny access to .git directories
    <DirectoryMatch "/\.git">
        Require all denied
    </DirectoryMatch>
    
    ErrorLog ${APACHE_LOG_DIR}/error.log
    CustomLog ${APACHE_LOG_DIR}/access.log combined
</VirtualHost>